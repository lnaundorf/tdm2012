stufeSet=false;numberSet=false;regionSet=false;key="";selectedSchool=null;selectedRegion=null;selectedElem=null;regionNumber=0;timeout=false;waiting=false;lastSearch="";validateAnswer=0;function switchResults(c){var b=document.getElementById("schoolsearch");if(b&&b.style.display=="block"){var a=selectedElem;if(c.keyCode==38){if(selectedElem.previousSibling!=null){highlightOut(selectedElem);highlightOver(a.previousSibling)}}else{if(c.keyCode==40){if(selectedElem==null){highlightOver(b.firstChild.firstChild.firstChild)}else{if(selectedElem.nextSibling!=null){highlightOut(selectedElem);highlightOver(a.nextSibling)}}}else{if(c.keyCode==13){schoolSearchBlur();highlightOut(selectedElem)}}}}}function searchSchool(b,d){if(b.keyCode!=40&&b.keyCode!=38){if(b.keyCode==13){var c=false}else{var c=true}if(!timeout){timeout=true;setTimeout(function(){timeout=false;if(waiting){waiting=false;invokeSearch(d,c)}},500);invokeSearch(d,c)}else{waiting=true}}else{var a=document.getElementById("schoolsearch");if(a&&b.keyCode==40&&selectedElem==null){a.style.display="block";highlightOver(a.firstChild.firstChild.firstChild)}}}function invokeSearch(f,e){var c=f.value;if(c!=lastSearch){lastSearch=c;var d=document.getElementById("schoolsearch");if(c.length<3&&d!=null){d.style.display="none"}else{var b=getXMLHttp();if(b){if(regionNumber!=0){var a="&region="+regionNumber}else{var a=""}b.open("GET","/scripts/schools.php?q="+encodeURIComponent(c)+a,true);b.onreadystatechange=function(){if(b.readyState==4){var l='<table class="searchtable">';var n=b.responseXML.getElementsByTagName("school");if(n.length==0){l+="<tr><td>Keine passende Schule gefunden</td></tr>"}for(i=0;i<n.length;i++){var k=n[i].getElementsByTagName("name")[0].childNodes[0].nodeValue;var h=n[i].getElementsByTagName("string")[0].childNodes[0].nodeValue;var m=n[i].getElementsByTagName("region")[0].childNodes[0].nodeValue;var g=n[i].getElementsByTagName("regionString")[0].childNodes[0].nodeValue;l+='<tr onmouseover="highlightOver(this)" onmouseout="highlightOut(this)" class="schoolresult"><td><div class="schoolinvisible">'+k+'</div><div class="schoolinvisible">'+m+'</div><span class="searchleft">'+h+'</span><span class="searchright">'+g+"</span></td></tr>"}selectedSchool=selectedRegion=selectedElem=null;d.innerHTML=l+"</table>";if(e){d.style.display="block"}}};b.send(null)}}}}function highlightOver(a){a.style.backgroundColor="#839DBA";selectedSchool=a.firstChild.childNodes[0].innerHTML;selectedRegion=a.firstChild.childNodes[1].innerHTML;selectedElem=a}function highlightOut(a){a.style.backgroundColor="white";selectedSchool=selectedRegion=selectedElem=null}function schoolSearchBlur(){if(selectedSchool!=null){document.getElementById("schoolinput").value=selectedSchool;var b=document.getElementById("regionSelect");if(b){var a=b.options;for(i=0;i<a.length;i++){if(a[i].value==selectedRegion){a[i].selected=true;changeRegion(b);break}}}}document.getElementById("schoolsearch").style.display="none"}function setNumber(c){for(i=1;i<=5;i++){if(i<=c){var a="block"}else{var a="none"}var b=document.getElementById("person"+i);b.style.display=a}document.getElementById("teamCount").value=c;if(!numberSet){var b=document.getElementById("numberzero");if(b){b.parentNode.removeChild(b)}numberSet=true;if(stufeSet){document.getElementById("submit").style.display="block"}}}function contactHint(b,a){if(a&&b.value=="Vorname Nachname"){b.value="";b.style.color=""}else{if(!a&&b.value==""&&isIE()){b.value="Vorname Nachname";b.style.color="#c7c7c7"}}}function changeRegion(a){if(!regionSet){regionSet=true}regionNumber=a[a.selectedIndex].value;var a=document.getElementById("regionzero");if(a){a.parentNode.removeChild(a)}}function setStufe(d){if(d==1){var c=new Array(7,8)}else{if(d==2){var c=new Array(9,10)}else{var c=new Array(11,12,13)}}for(i=1;i<=5;i++){var a="";var b=document.getElementById("stufe_span"+i);for(j=0;j<c.length;j++){a+='<li><label name="person'+i+'klasse"><input type="radio" name="KlasseInput'+i+'" value="'+c[j]+'"><span>Klasse '+c[j]+"</span></label></li>"}b.innerHTML=a}if(!stufeSet){var b=document.getElementById("stufezero");if(b){b.parentNode.removeChild(b)}stufeSet=true;if(numberSet){document.getElementById("submit").style.display="block"}}}function validate_registration(){validateAnswer=0;setTimeout(function(){if(validateAnswer==0){document.getElementById("ajaxloader").style.display="inline";var q=document.getElementById("submitButton");if(q){q.value="überprüfen...";q.disabled=true}}},250);var d=document.getElementsByName("anmeldung");var b=d[0][d[0].selectedIndex].value;var p=d[1].value;var n=d[2][d[2].selectedIndex].value;var m=d[3].value;var a=d[4].value;if(a=="Vorname Nachname"){a=""}var k=d[5].value;var o=getCheckedValue(document.getElementsByName("BegleitInput"));var g=d[6][d[6].selectedIndex].value;var h=new Array(g);for(i=1;i<=g;i++){var e=new Array(4);var l=document.getElementsByName("personInput"+i);e[0]=l[0].value;if(e[0]==undefined){e[0]=""}e[1]=l[1].value;if(e[1]==undefined){e[1]=""}e[2]=getCheckedValue(document.getElementsByName("KlasseInput"+i));e[3]=getCheckedValue(document.getElementsByName("EssenInput"+i));h[i-1]=e}var f=getXMLHttp();if(f){var c="stufe="+b+"&schule="+p+"&region="+n+"&teamName="+m+"&kontakt="+a+"&email="+k+"&begleitEssen="+o+"&count="+g;for(i=1;i<=g;i++){var e=h[i-1];c+="&vorname"+i+"="+e[0]+"&name"+i+"="+e[1]+"&klasse"+i+"="+e[2]+"&essen"+i+"="+e[3]}f.open("POST","/scripts/validate_form.php",true);f.setRequestHeader("Content-type","application/x-www-form-urlencoded");f.setRequestHeader("Content-length",c.length);f.setRequestHeader("Connection","close");f.onreadystatechange=function(){if(f.readyState==4){document.getElementById("ajaxloader").style.display="none";var q=document.getElementById("submitButton");q.value="Daten überprüfen";q.disabled=false;updateForm(f.responseXML)}};f.send(c)}}function getCheckedValue(b){var c=b.length;if(c==undefined){if(b.checked){return b.value}else{return -1}}for(var a=0;a<c;a++){if(b[a].checked){return b[a].value}}return -1}function getXMLHttp(){var a=null;try{a=new XMLHttpRequest()}catch(b){try{a=new ActiveXObject("Microsoft.XMLHTTP")}catch(b){try{a=new ActiveXObject("Msxml2.XMLHTTP")}catch(b){a=null}}}return a}function updateForm(d){var k=d.getElementsByTagName("reviewElement");if(k.length>0){document.getElementById("form").style.display="none";document.getElementById("submit").style.display="none";for(i=0;i<k.length;i++){var c=k[i].getElementsByTagName("name")[0].childNodes[0].nodeValue;var h=k[i].getElementsByTagName("value")[0].childNodes[0].nodeValue;if(c=="count"){for(j=1;j<=5;j++){if(j<=h){document.getElementById("table"+j).style.display="block"}else{document.getElementById("table"+j).style.display="none"}}if(h==4){document.getElementById("hr4").style.display="block";document.getElementById("hr5").style.display="none"}else{if(h==5){document.getElementById("hr4").style.display="block";document.getElementById("hr5").style.display="block"}else{document.getElementById("hr4").style.display="none";document.getElementById("hr5").style.display="none"}}}var a=document.getElementById(c+"Review");if(a!=undefined){a.innerHTML=h}}var b=d.getElementsByTagName("key");if(b.length>0){key=b[0].childNodes[0].nodeValue}document.getElementById("review").style.display="block";window.scrollTo(0,0)}var g=d.getElementsByTagName("element");var e=false;for(i=0;i<g.length;i++){var c=g[i].getElementsByTagName("name")[0].childNodes[0].nodeValue;var h=g[i].getElementsByTagName("correct")[0].childNodes[0].nodeValue;if(c=="email"){var f=document.getElementById("mail-help");if(h==0){f.style.display="block"}else{f.style.display="none"}}else{if(c=="teamName"){var f=document.getElementById("team-help");if(h<0){f.style.display="block"}else{f.style.display="none"}}}var a=document.getElementById(c+"div");if(a!=undefined){if(h<=0){if(!e){document.getElementById("messages").innerHTML="Fehler: Bitte füllen Sie alle angegebenen Felder aus";e=true}a.setAttribute("class","clearfix error")}else{a.setAttribute("class","clearfix")}}}if(!e){document.getElementById("messages").innerHTML="&nbsp;"}validateAnswer=1}function setBack(){document.getElementById("form").style.display="block";document.getElementById("submit").style.display="block";document.getElementById("review").style.display="none";window.scrollTo(0,0)}function completeRegistration(){if(key!=""){var a=getXMLHttp();if(a){a.open("GET","/scripts/complete_registration.php?key="+key,true);a.onreadystatechange=function(){if(a.readyState==4){var b=a.responseXML.getElementsByTagName("registrationAnswer")[0].getElementsByTagName("status")[0].childNodes[0].nodeValue;if(b==4){document.getElementById("completeActions").style.display="none";document.getElementById("messageText").innerHTML="<div class='alert-message success'>Ihre Anmeldung war erfolgreich. Sie erhalten in Kürze eine E-Mail mit einer Kopie der Anmeldedaten an die angegebene Mail-Adresse.</div>"}else{document.getElementById("messageText").innerHTML="<div class='alert-message error'>Bei Ihrer Anmeldung ist ein Fehler aufgetreten. Bitte versuchen Sie es zu einem späteren Zeitpunkt erneut.</div>"}window.scrollTo(0,0)}};a.send(null)}}}function isIE(){return/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)};